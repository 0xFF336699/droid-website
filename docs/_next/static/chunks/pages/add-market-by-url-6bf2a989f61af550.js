(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{93896:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/add-market-by-url",function(){return n(22462)}])},22462:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var r=n(50612),i=n(75936),o=n(73256),l=n(25065),s=n(40242),a=n(94344),c=n(86035),u=n(3072),d=n(65820),h=n(12066),m=n(13124),f=n(88171),x=n(22467),p=(e,t,n)=>new Promise((r,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},l=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);s((n=n.apply(e,t)).next())});class y{loadContent(e){console.log("loadContent_fn",e),this.currentLoadCallback=null,this.currentErrorCallback=null;let t="\n            <script>\n                const IFRAME_ID = '".concat(this.iframeId,"';\n                function notifyResize() {\n                    const body = document.body;\n                    const html = document.documentElement;\n                    \n                    // 获取实际内容高度（取最大值）\n                    const height = Math.max(\n                    const height = Math.max(\n                        body.scrollHeight,\n                        body.offsetHeight,\n                        html.clientHeight,\n                        html.scrollHeight,\n                        html.offsetHeight\n                    );\n                    \n                    // 获取实际内容宽度（取最大值）\n                    const width = Math.max(\n                        body.scrollWidth,\n                        body.offsetWidth,\n                        html.clientWidth,\n                        html.scrollWidth,\n                        html.offsetWidth\n                    );\n                    \n                    window.parent.postMessage({ \n                        type: 'resize', \n                        height, \n                        width,\n                        iframeId: IFRAME_ID \n                    }, '*');\n                }\n                \n                // 监听DOM变化\n                const observer = new MutationObserver(() => {\n                    requestAnimationFrame(notifyResize);\n                });\n                \n                observer.observe(document.body, { \n                    childList: true, \n                    subtree: true, \n                    attributes: true \n                });\n                \n                // 监听图片加载完成\n                document.addEventListener('load', function(e) {\n                    if (e.target.tagName === 'IMG') {\n                        notifyResize();\n                    }\n                }, true);\n                \n                // 监听窗口大小变化\n                window.addEventListener('resize', notifyResize);\n                \n                // 初始化时多次检查大小\n                window.addEventListener('load', () => {\n                    notifyResize();\n                    // 延迟再次检查，处理动态内容\n                    setTimeout(notifyResize, 100);\n                    setTimeout(notifyResize, 500);\n                });\n                \n                // 立即执行一次\n                notifyResize();\n            <\/script>\n        "),n=e.includes("</body>")?e.replace("</body>","".concat(t,"</body>")):"".concat(e).concat(t);this.iframe.srcdoc=n}setMinSize(e,t){this.minWidth=e,this.minHeight=t}setMaxSize(e,t){this.maxWidth=e,this.maxHeight=t}handleIframeMessage(e){if("resize"===e.data.type&&e.data.iframeId===this.iframeId){let{height:t,width:n}=e.data,r=window.innerWidth;null!==this.minWidth&&(n=Math.max(n,this.minWidth)),null!==this.minHeight&&(t=Math.max(t,this.minHeight)),n=null!==this.maxWidth?Math.min(n,this.maxWidth):Math.min(n,r),null!==this.maxHeight&&(t=Math.min(t,this.maxHeight)),this.container.style.height="".concat(t,"px"),this.container.style.width="".concat(n,"px")}}loadUrl(e,t,n){return p(this,null,function*(){this.currentLoadCallback=t||null,this.currentErrorCallback=n||null,this.iframe?(yield this.testUrl(e),this.iframe.src=e):console.error("IFrameContainer: iframe element is null in loadUrl!")})}testUrl(e){return p(this,null,function*(){try{let t=yield x.A.get(e);console.log("res=",t)}catch(e){console.error("test load url error",e)}})}loadUrlAsContent(e){return p(this,null,function*(){console.log("laodUrlAsContent_fn",e);try{let t=yield fetch(e);if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let n=yield t.text();this.loadContent(n)}catch(e){throw console.error("Failed to load URL content:",e),e}})}getContainer(){return this.container}setSize(e,t){this.container.style.width=e,this.container.style.height=t}constructor(){this.minWidth=null,this.minHeight=null,this.maxWidth=null,this.maxHeight=null,this.currentLoadCallback=null,this.currentErrorCallback=null,this.iframeId="iframe_"+Math.random().toString(36).substr(2,9),this.container=document.createElement("div"),this.iframe=document.createElement("iframe"),this.container.style.width="100%",this.container.style.height="100%",this.container.style.overflow="hidden",this.container.style.position="relative",this.container.style.maxWidth="100%",this.container.style.margin="0 auto",this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.border="none",this.iframe.style.overflow="hidden",this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("seamless","seamless"),this.iframe.onload=()=>{this.currentLoadCallback&&this.currentLoadCallback(),(0,window.iframeResize)({onReady:e=>{},license:"GPLv3",waitForLoad:!0,log:!1,checkOrigin:!1},"#".concat(this.iframeId))},this.iframe.onerror=(e,t,n,r,i)=>{console.error('%cIFrameContainer: iframe "error" event triggered.',"color: red; font-weight: bold;",e);let o=i||Error("string"==typeof e?e:"Failed to load iframe content");this.currentErrorCallback&&this.currentErrorCallback(o)},this.container.appendChild(this.iframe),this.iframe.id=this.iframeId,window.addEventListener("message",this.handleIframeMessage.bind(this))}}var g=n(76806),v=n(10216),b=(e,t,n)=>new Promise((r,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},l=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);s((n=n.apply(e,t)).next())});let w=e=>{let{style:t,className:n,url:i,content:o,minWidth:l,minHeight:s,maxWidth:c,maxHeight:u,onError:m,onLoad:f}=e,x=(0,a.useRef)(null),p=(0,a.useRef)(null),[w,j]=(0,a.useState)(!1),[k,A]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!p.current&&x.current){p.current=new y;let e=p.current;e.setMinSize(null!=l?l:null,null!=s?s:null),e.setMaxSize(null!=c?c:null,null!=u?u:null),x.current.appendChild(e.getContainer())}return()=>{x.current&&p.current&&(x.current.removeChild(p.current.getContainer()),p.current=null)}},[l,s,c,u]),(0,a.useEffect)(()=>{let e=p.current;e&&b(void 0,null,function*(){j(!0),A(null);try{o?(e.loadContent(o),j(!1),null==f||f()):i?e.loadUrl(i,()=>{j(!1),A(null),null==f||f()},e=>{console.error("%cIFrameReactContainer: handleError (callback from IFrameContainer) triggered.","color: red;",e),j(!1),A(e),null==m||m(e)}):j(!1)}catch(e){if(console.error(">>> Sync Error during loadContentOrUrl setup:",e),e instanceof Error)j(!1),A(e),null==m||m(e);else{let e=Error("An unknown error occurred during setup");j(!1),A(e),null==m||m(e)}}})},[i,o,m,f,p.current]),(0,r.jsxs)("div",{ref:x,style:t,className:n,children:[w&&(0,r.jsxs)(h.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:2},children:[(0,r.jsx)(g.A,{size:24}),(0,r.jsx)(d.A,{variant:"body2",sx:{ml:1},children:"Loading preview..."})]}),k&&!w&&(0,r.jsxs)(v.A,{severity:"error",sx:{m:1},children:["Preview Error: ",k.message]})]})};var j=n(41878),k=n(76528),A=n(64901);let C=e=>{let{isFullMarketPage:t,onMarketConfigReady:n,initialValue:i="",initialIsUrl:o=!0}=e,[l,c]=(0,a.useState)(i),[u,d]=(0,a.useState)(o),[m,x]=(0,a.useState)(""),{t:p}=(0,s.useTranslation)("homepage/components/page/add-market-by-url/ui/market-input-form/content"),y=e=>{try{return new URL(e),!0}catch(e){return!1}},g=(0,a.useCallback)((e,t)=>{console.log("Processing input:",e,"Is URL:",t),t?e&&y(e)?(x(""),n({str:e,isUrl:!0})):e?x("Please enter a valid URL."):x(""):(x(""),n({str:e,isUrl:!1}))},[n]),{run:v}=(0,A.A)(g,{wait:500}),b="";b=p(u?t?"content.full.url":"content.item.url":t?"content.full.html":"content.item.html");let w="";return w=u?t?"https://github.com/your-name/your-repo/docs/market.html":"https://github.com/your-name/your-repo/docs/summary.html":t?"<html><body><div>script list<div></body></html>":"<html><body><div>".concat(p("content.item.come"),'<a href="https://github.com/your-name/your-repo/docs/index.html">').concat(p("content.item.myMarketName"),"</a>").concat(p("content.item.stroll"),"</div></body></html>"),(0,r.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,r.jsx)(f.A,{label:b,variant:"outlined",fullWidth:!0,value:l,onChange:e=>{let t=e.target.value;c(t),v(t,u)},error:!!m,helperText:m,placeholder:w,multiline:!u,rows:u?1:4}),(0,r.jsx)(k.A,{control:(0,r.jsx)(j.A,{checked:u,onChange:e=>{let t=e.target.checked;d(t),g(l,t)}}),label:p("content.isUrl")})]})},E=()=>{let[e,t]=(0,a.useState)(""),[n,i]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[x,p]=(0,a.useState)(null),[y,g]=(0,a.useState)(null),{t:v}=(0,s.useTranslation)("homepage/components/page/add-market-by-url/ui/content"),b={minWidth:"300px",minHeight:"200px",border:"1px solid #ccc",display:"block"},j=(0,a.useCallback)(e=>{p(e)},[]),k=(0,a.useCallback)(e=>{g(e)},[]);return(0,r.jsx)(c.A,{sx:{maxWidth:800,margin:"auto",mt:2},children:(0,r.jsxs)(u.A,{children:[(0,r.jsx)(h.A,{sx:{mb:2,color:"error.main"},children:v("content.warning")}),(0,r.jsx)(d.A,{variant:"h5",component:"h2",gutterBottom:!0,children:v("content.setNewMarket")}),(0,r.jsxs)(h.A,{sx:{mb:2},children:[(0,r.jsx)(f.A,{fullWidth:!0,label:v("content.marketName"),variant:"outlined",value:e,onChange:e=>t(e.target.value),sx:{mb:1}}),(0,r.jsx)(f.A,{fullWidth:!0,label:v("content.marketSummary"),variant:"outlined",value:n,onChange:e=>i(e.target.value),multiline:!0,rows:2,sx:{mb:1}}),(0,r.jsx)(f.A,{fullWidth:!0,label:v("content.marketDescription"),variant:"outlined",value:o,onChange:e=>l(e.target.value),multiline:!0,rows:4,sx:{mb:2}})]}),(0,r.jsx)(d.A,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:v("content.itemMarket")}),(0,r.jsx)(C,{onMarketConfigReady:j,isFullMarketPage:!1}),(0,r.jsx)(d.A,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:v("content.fullMarket")}),(0,r.jsx)(C,{onMarketConfigReady:k,isFullMarketPage:!0}),(0,r.jsx)(m.A,{sx:{my:2}}),(e||n||o||x||y)&&(0,r.jsxs)(h.A,{children:[(0,r.jsx)("hr",{}),(0,r.jsx)(d.A,{sx:{textAlign:"center"},variant:"h6",component:"h3",gutterBottom:!0,children:v("content.settingPreview")}),(0,r.jsxs)(d.A,{variant:"body1",component:"p",paragraph:!0,children:[(0,r.jsxs)("strong",{children:[v("content.marketName"),":"]})," ",e||v("content.isNotSet")]}),(0,r.jsxs)(d.A,{variant:"body1",component:"p",paragraph:!0,children:[(0,r.jsxs)("strong",{children:[v("content.marketSummary"),":"]})," ",n||v("content.isNotSet")]}),(0,r.jsxs)(d.A,{variant:"body1",component:"p",paragraph:!0,children:[(0,r.jsxs)("strong",{children:[v("content.marketDescription"),":"]})," ",o||v("content.isNotSet")]}),x&&(0,r.jsxs)(h.A,{sx:{mb:2},children:[(0,r.jsx)(d.A,{variant:"subtitle1",gutterBottom:!0,children:v("content.marketCardPreview")}),(0,r.jsx)(w,{url:x.isUrl?x.str:void 0,content:x.isUrl?void 0:x.str,style:b})]}),y&&(0,r.jsxs)(h.A,{children:[(0,r.jsx)(d.A,{variant:"subtitle1",gutterBottom:!0,children:v("content.marketFullPreview")}),(0,r.jsx)(w,{url:y.isUrl?y.str:void 0,content:y.isUrl?void 0:y.str,style:b})]})]})]})})};function P(){let e=new l.m,{t}=(0,s.useTranslation)("homepage/pages/add-market-by-url/content");return(0,r.jsxs)(i.G,{children:[(0,r.jsx)(o.W,{appbarProps:{title:t("content.title"),back:!0,backDispatcher:e}}),(0,r.jsx)(E,{})]})}},75936:(e,t,n)=>{"use strict";n.d(t,{G:()=>m});var r=n(50612),i=n(40242),o=n(23026),l=n(42590),s=n(57555),a=n(53757),c=n(94344),u=n(4216),d=n(27068),h=n.n(d);function m(e){let{children:t}=e,n=(0,a.useRouter)(),d="scrollPositionInfo",m=window.location.href.split("#")[0],f=h().namespace(m),x="dynamic-".concat(m),p=f.get(x);return p||(p={}),p=(0,o.I$)(p),(0,c.useEffect)(()=>{n.beforePopState(e=>(f.clearAll(),!0))}),(0,c.useEffect)(()=>(f.set(x,p),(0,l.c)(p,()=>{f.set(x,p)})),[]),(0,c.useEffect)(()=>{let e=f.get(d)||{x:0,y:0};function t(e){f.set(d,{x:window.scrollX,y:window.scrollY})}function n(){window.addEventListener("scroll",t)}return 0==e.x&&0==e.y?n():window.requestAnimationFrame(()=>{window.scrollTo(e.x,e.y),n()}),function(){window.removeEventListener("scroll",t)}}),(0,r.jsx)(s.q,{value:f,children:(0,r.jsx)(s.p,{value:p,children:(0,r.jsx)(u.xC,{i18n:i.i18n,children:t})})})}(0,i.i18nInit)()},73256:(e,t,n)=>{"use strict";n.d(t,{W:()=>N});var r=n(50612),i=n(35011),o=n(75485),l=n(9655),s=n(67779),a=n(16425),c=n(23235),u=n(92776),d=n(64909),h=n(61150),m=n(88778),f=n(62754),x=n(28542),p=n(94344),y=n(53757),g=n(25065),v=(e,t,n)=>new Promise((r,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},l=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);s((n=n.apply(e,t)).next())});let b=new g.m,w={dipsatcher:b,screenLockCount:0,switchPage:()=>v(void 0,null,function*(){b.dispatch("switchPage"),w.screenLockCount=0}),listenSwitchPage:e=>b.addListener("switchPage",e)};var j=n(76838),k=n(2196);function A(e){let{children:t}=e,n=(0,y.useRouter)();return(0,r.jsx)(j.N,{mode:"wait",children:(0,r.jsx)(k.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:t},n.route)})}let C=0;function E(e){let{children:t}=e,n="app-shell-".concat(C++);return(0,p.useEffect)(()=>{let e=document.querySelector("#".concat(n)),t=w.listenSwitchPage(()=>{if(!e)return});if(e)return e.addEventListener("click",e=>{0!=w.screenLockCount&&(e.stopPropagation(),e.preventDefault())}),()=>{t()}},[]),(0,r.jsx)(s.A,{id:n,children:(0,r.jsx)(A,{children:t})})}var P=n(22726),M=Object.defineProperty,S=Object.defineProperties,L=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,z=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,U=(e,t)=>{for(var n in t||(t={}))R.call(t,n)&&z(e,n,t[n]);if(I)for(var n of I(t))W.call(t,n)&&z(e,n,t[n]);return e},H=(e,t)=>S(e,L(t));function _(e){let{children:t,window:n}=e,l=(0,i.A)({target:n?n():void 0});return(0,r.jsx)(o.A,{appear:!1,direction:"down",in:!l,children:null!=t?t:(0,r.jsx)("div",{})})}function F(e){let{children:t,window:n}=e,o=(0,i.A)({target:n?n():void 0,disableHysteresis:!0,threshold:100});return(0,r.jsx)(l.A,{in:o,children:(0,r.jsx)(s.A,{"data-id":"content-scroll-top-button",onClick:e=>{let t=(e.target.ownerDocument||document).querySelector("#back-to-top-anchor");t&&t.scrollIntoView({block:"center"})},role:"presentation",sx:{position:"fixed",bottom:16,right:16},children:t})})}function N(e){let{children:t,appbarProps:n,titleConf:i}=e,o=(0,y.useRouter)();return(0,r.jsx)(E,{children:(0,r.jsxs)(p.Fragment,{children:[(0,r.jsx)(a.Ay,{}),(0,r.jsx)(_,H(U({},e),{children:(0,r.jsx)(c.A,{color:"inherit",children:(0,r.jsxs)(u.A,{children:[(0,r.jsx)(f.A,{onClick:function(){if(!m.W.askHistoryBack().defaultPrevented){if(n.backDispatcher){let e={defaultPrevented:!1};if(n.backDispatcher.dispatch("back",e),e.defaultPrevented)return}o.back()}}}),n.title]})})})),(0,r.jsx)(u.A,{id:"back-to-top-anchor"}),(0,r.jsx)(d.A,{sx:{padding:"0",marginTop:"17px"},children:(0,r.jsx)(P.A,{titleConf:i,children:t})}),(0,r.jsx)(F,H(U({},e),{children:(0,r.jsx)(h.A,{size:"small","aria-label":"scroll back to top",children:(0,r.jsx)(x.A,{})})}))]})})}},22726:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var r=n(50612),i=n(67779),o=n(85364),l=n(64909),s=n(94344),a=n(77570),c=n(40242),u=(e,t,n)=>new Promise((r,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},l=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);s((n=n.apply(e,t)).next())});function d(){return a.Cu?(0,r.jsxs)(i.A,{children:[(0,r.jsx)(o.A,{onClick:()=>{window.location.reload()},children:"reload"}),new Date().toLocaleString()]}):(0,r.jsx)(r.Fragment,{children:"  "})}let h=(0,s.createContext)({x:0,y:0}),m=0;function f(e){let{children:t,titleConf:n}=e;m++;let o=(0,s.useContext)(h),a="".concat(Date.now()+Math.random()*Date.now());return(0,s.useEffect)(()=>{!function(){u(this,null,function*(){if(!n)return;let e=n.title;n.ns&&(e=yield(0,c.loadI18nValue)(n.ns,n.key||"content.title")),e&&(document.title=e)})}()},[]),(0,s.useEffect)(()=>{let e=document.getElementsByClassName(a)[0];if(!e)return;e.scrollTop=o.y;let t=()=>{var t=e.scrollTop;o.y=t};return e.removeEventListener("scroll",t),e.addEventListener("scroll",t,{passive:!0}),()=>e.removeEventListener("scroll",t)},[a,o]),(0,r.jsx)(l.A,{className:a,sx:{flexGrow:1,overflow:"auto",padding:"0px"},children:(0,r.jsxs)(i.A,{children:[(0,r.jsx)(d,{}),t]})})}function x(e){let{children:t,titleConf:n}=e;return(0,r.jsx)(f,{titleConf:n,children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[602,663,872,162,426,140,889,171,524,327,636,593,792],()=>t(93896)),_N_E=e.O()}]);