(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[587],{43932:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-editor",function(){return n(22147)}])},33218:(e,t,n)=>{"use strict";n.d(t,{j:()=>m,v:()=>A});var r=n(21725),i=n(33914);let o={id:"selectAppActionItem-7537eb25-586d-4178-9d9b-b817706a4c6b",i18nNs:"homepage/components/page/action-list/groups/app/app-select/content",nameKey:"content.name",group:"selectAppActionItem.group",descriptionKey:"content.description",type:"page",LinkRender:(0,i.IS)("/app-selector","selectAppActionItem-7537eb25-586d-4178-9d9b-b817706a4c6b",{actionType:r.F.type})};var c=n(39561),a=n(99672),s=n(77758),l=n(77545),d=n(15751),p=n(26841),g=n(27458),u=n(21858);let x={id:"to-app-main-page-action-item-df1c",i18nNs:"homepage/components/page/action-list/groups/app/to-app-main-page/content",nameKey:"content.name",group:"toAppMainPageActionItem.group",descriptionKey:"content.description",type:"action",LinkRender:(0,i.cI)(j)};async function h(){return c.nd?await (0,a.U)(!0):{pn:"".concat((0,u.g0)(Math.floor(5*Math.random())+5),".").concat((0,u.g0)(Math.floor(5*Math.random())+5),".").concat((0,u.g0)(Math.floor(5*Math.random())+5)),an:(0,u.g0)(Math.floor(5*Math.random())+5)}}async function j(e){let{query:t}=e,n=await h(),r=(0,d.getTriggerOrActionListPageParams)(t),i=l.w.mergeDataToDefultData({javaData:{pn:n.pn,an:n.an}});p.T.dispatchEditEvent(p.T.EditType.add,{data:i,projectMemberType:g.K.actionGroup,projectInfo:r.data}),window.history.back(),s.yx.openSelfByPackage()}async function f(e){let{query:t}=e,n=await h(),r=(0,d.getTriggerOrActionListPageParams)(t);p.T.dispatchEditEvent(p.T.EditType.updateJavaData,{data:n,projectMemberType:g.K.action,projectInfo:r.data}),s.yx.openSelfByPackage()}l.w.onClickChange=f;let m=[{i18nNs:"homepage/components/page/action-list/groups/app/content",nameKey:"content.name",descriptionKey:"content.description",items:[o,x]}];async function A(){}},20017:(e,t,n)=>{"use strict";n.d(t,{J:()=>b,R:()=>y});var r=n(83421),i=n(15751),o=n(72028),c=n(27458),a=n(26841),s=n(91239),l=n(33914);let d={id:"timeout-trigger-item-ce8c",i18nNs:"homepage/components/page/trigger-list/groups/time/timeout/content",nameKey:"content.name",group:"timeoutTriggerItem.group",descriptionKey:"content.description",type:"trigger",LinkRender:(0,l.cI)(function(e){let{query:t,item:n}=e,l=(0,i.getTriggerOrActionListPageParams)(t);switch(t.type){case r.ActionOrTriggerListTypeEnum.addAction:let d=o.V.createDefultData();if(!l.data.triggerGroup)return(0,s.w)("triggerGroup is not found",t);a.T.dispatchEditEvent(a.T.EditType.add,{projectMemberType:c.K.triggerGroup,data:d,projectInfo:l.data}),window.history.back();case r.ActionOrTriggerListTypeEnum.updateAction:}})};var p=n(39561),g=n(99672),u=n(77758),x=n(88474),h=n(21858);let j={id:"activity-in-item-ce8c",i18nNs:"homepage/components/page/trigger-list/groups/app/activity/content",nameKey:"content.name",group:"activityInItem.group",descriptionKey:"content.description",type:"trigger",LinkRender:(0,l.cI)(m)};async function f(){return p.nd?await (0,g.U)(!0):{pn:"".concat((0,h.g0)(Math.floor(5*Math.random())+5),".").concat((0,h.g0)(Math.floor(5*Math.random())+5),".").concat((0,h.g0)(Math.floor(5*Math.random())+5)),an:(0,h.g0)(Math.floor(5*Math.random())+5),cn:(0,h.g0)(Math.floor(5*Math.random())+5)}}async function m(e){let{query:t}=e,n=await f(),r=(0,i.getTriggerOrActionListPageParams)(t),o=x.S.mergeDataToDefultData({javaData:{pn:n.pn,an:n.an,cn:n.cn}});a.T.dispatchEditEvent(a.T.EditType.add,{data:o,projectMemberType:c.K.triggerGroup,projectInfo:r.data}),console.log("ccccccccccccccall open self"),u.yx.openSelfByPackage(),window.history.back()}async function A(e){let{query:t}=e,n=await f(),r=(0,i.getTriggerOrActionListPageParams)(t);a.T.dispatchEditEvent(a.T.EditType.updateJavaData,{data:n,projectMemberType:c.K.trigger,projectInfo:r.data}),u.yx.openSelfByPackage()}x.S.onClickChange=A;let y=[{i18nNs:"homepage/components/page/trigger-list/groups/time/content",nameKey:"content.name",descriptionKey:"content.description",items:[d]},{i18nNs:"homepage/components/page/trigger-list/groups/app/content",nameKey:"content.name",descriptionKey:"content.description",items:[j]}];async function b(){}},22147:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>e8});var r=n(50612),i=n(25065);window.android,window.global||(window.global=window);let o=new i.m;var c=n(15751),a=n(87696),s=n(67835),l=n(87825),d=n(81681),p=n(2599),g=n(23026),u=n(96421),x=n(42590),h=n(36734),j=n(38212),f=n(80740),m=n(3607),A=n(22066),y=n(94011),b=n(94344),k=n(7843);function v(e){let{setText:t,title:n,cancelText:i,saveText:o,contentText:c,helperText:a,minHeight:s,children:l}=e,{t:d}=(0,k.Bd)("fanfanlo/mui/dialog/content"),[p,g]=(0,b.useState)(""),[u,x]=(0,b.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{style:{cursor:"pointer",width:"100%",textAlign:"center",display:"inline-block",backgroundColor:"",minHeight:s||"1rem"},onClick:()=>x(!0),children:(0,r.jsx)("span",{children:l||""})}),u&&(0,r.jsxs)(h.A,{open:u,onClose:()=>x(!1),children:[(0,r.jsx)(j.A,{children:n||d("EditableText.title")}),c&&(0,r.jsx)(f.A,{children:c}),(0,r.jsx)(f.A,{children:(0,r.jsx)(m.A,{id:"editable-text","aria-label":"editable-text",autoFocus:!0,required:!0,fullWidth:!0,helperText:a,variant:"standard",value:p,onChange:e=>{g(e.target.value)}})}),(0,r.jsxs)(A.A,{children:[(0,r.jsx)(y.A,{id:"editable-text-cancel","data-id":"editable-text-cancel",onClick:()=>x(!1),children:i||d("EditableText.cancel")}),(0,r.jsx)(y.A,{id:"editable-text-save","data-id":"editable-text-save",onClick:()=>{x(!1),t(p)},children:o||d("EditableText.save")})]})]})]})}var C=n(60789),w=n(40614),T=n(6048),P=n(67779),I=n(64565),S=n(17777),E=n(96142),O=n(21239),G=n(38149),D=n(85364),L=n(53757),M=n(84116),_=n(38712),B=n(32537),K=n.n(B);let q=new Map;function N(e){let t=function(e){let t=q.get(e)||[];return t[t.length-1]}(e.id);return!(t&&K().isEqual(t.project,e))&&(!function(e){M.o.runPauseProxyFn(()=>{e.project=K().cloneDeep((0,_.EL)(e.project))});let t=q.get(e.project.id);if(!t){q.set(e.project.id,[e]);return}t.push(e)}({index:t?t.index+1:0,project:e,date:new Date().toISOString()}),!0)}var R=n(40242),U=n(52591),$=(e,t,n)=>new Promise((r,i)=>{var o=e=>{try{a(n.next(e))}catch(e){i(e)}},c=e=>{try{a(n.throw(e))}catch(e){i(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,c);a((n=n.apply(e,t)).next())});let z=(0,g.I$)({}),F=new i.m,J={edit:e=>z[e.id]=function(e){let t=(0,g.I$)({project:e,askStay:!1,giveup:!1,updated:!1,historyId:0,testTime:new Date().toLocaleString(),save:()=>$(this,null,function*(){t.updated=!1,t.askStay=!1,t.giveup=!1,a.D.saveProject(e),F.dispatch("project-saved",e);let n=yield(0,R.loadI18nValue)("droid-project/project/manager/content","edit-project-info-utils.projectSaved");U.Ay.success(n)})});return t}(e)},W=(0,b.createContext)({});var V=n(52229),X=n(82987),H=n(7892);let Z=0,Q=new WeakMap;function Y(e){let t=Q.get(e)||(0,g.I$)({version:++Z,count:0,key:"".concat(Z,"-0")});return Q.has(e)||(Q.set(e,t),(0,g.Ax)(e).addListener(H._l,(e,n)=>{t.count++,t.version=++Z,t.key="".concat(t.version,"-").concat(t.count)})),t}var ee=n(96062),et=n(63437),en=n(4079),er=n(49820),ei=n(17387),eo=n(48658),ec=n(83421),ea=n(91884),es=n(25355),el=n(18668),ed=Object.defineProperty,ep=Object.getOwnPropertySymbols,eg=Object.prototype.hasOwnProperty,eu=Object.prototype.propertyIsEnumerable,ex=(e,t,n)=>t in e?ed(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eh=(e,t)=>{for(var n in t||(t={}))eg.call(t,n)&&ex(e,n,t[n]);if(ep)for(var n of ep(t))eu.call(t,n)&&ex(e,n,t[n]);return e};function ej(e,t){let[n,r]=(0,b.useState)(e);return(0,b.useEffect)(()=>{(0,x.c)(e,t=>{K().isArray(t.target)?[...t.target]:t.target,r(K().isArray(e)?[...e]:eh({},e))},t)},[]),[n]}var ef=n(58553),em=n(42623);function eA(e){let{list:t,index:n}=e,i=new l.tG(!1,"Check2_fn");i.isPaused=!0,i.log("list=",t);let[o]=ej(t),a=(0,b.useContext)(c.GroupCheckList1Context);return i.log("l=",o),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(ei.A,{container:!0,children:[(0,r.jsx)(ei.A,{container:!0,size:"grow",children:o.map((e,n)=>(0,r.jsx)(ei.A,{children:(0,r.jsx)(ea.A,{children:(0,r.jsx)(es.A,{label:n.toString(),control:(0,r.jsx)(em.A,{"data-id":"group-check-checkbox","data-checked":e,"data-value":e,checked:e,onChange:e=>{t[n]=e.target.checked}})})})},p._.getNewCountId().toString()))}),(0,r.jsx)(ei.A,{children:(0,r.jsx)(ef.b,{title:"提醒",onConfirm:function(){a.splice(n,1)},content:"您要删除此条校验吗？",children:(0,r.jsx)(E.A,{"data-id":"group-check-remove",children:(0,r.jsx)(eo.A,{})})})})]})})}function ey(e){let{list:t}=e,n=new l.tG(!1,"Check1_fn");return n.isPaused=!0,n.log("Check1 list=",t),(0,r.jsx)(c.GroupCheckList1Context.Provider,{value:t,children:t.map((e,n)=>(0,r.jsx)(eA,{list:t[n],index:n},Y(e).key))})}function eb(e){let{group:t}=e,n=new l.tG(!1,"GroupCheck_fn");n.isPaused=!0;let[i]=(0,d.x)(t,"isSequential",t.isSequential),[o]=(0,d.x)(t,"list",t.list),[c]=ej(o),[a]=(0,d.x)(c,"length",c.length),[s]=(0,d.x)(t,"checks",t.checks),[p]=ej(s);return((0,b.useEffect)(()=>{n.log("updateChecks2_fn","listSize=",a,t.checks),t.checks.forEach(e=>{n.log("updateChecks2_fn","checks2=",e);for(let t=e.length;t<a;t++)e.push(!0);e.length=a})},[a]),n.log("list.length=",c.length),c.length<=1||i)?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(P.A,{children:[(0,r.jsx)(ei.A,{container:!0,children:(0,r.jsx)(ei.A,{children:(0,r.jsx)(D.A,{"data-id":"group-add-check-list.875aec4f-5049-426a-a395-0ac0c6666a35",onClick:()=>{t.checks.push(Array(a).fill(!0))},children:"添加校验组"})})}),(0,r.jsx)(ey,{list:t.checks})]})}var ek=Object.defineProperty,ev=Object.defineProperties,eC=Object.getOwnPropertyDescriptors,ew=Object.getOwnPropertySymbols,eT=Object.prototype.hasOwnProperty,eP=Object.prototype.propertyIsEnumerable,eI=(e,t,n)=>t in e?ek(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eS=(e,t)=>{for(var n in t||(t={}))eT.call(t,n)&&eI(e,n,t[n]);if(ew)for(var n of ew(t))eP.call(t,n)&&eI(e,n,t[n]);return e},eE=(e,t)=>ev(e,eC(t));function eO(e){let{query:t,attrs:n,path:i,btnId:o,children:c}=e,a=(0,L.useRouter)();return t.backPath=a.pathname,(0,r.jsx)(D.A,eE(eS({onClick:function(){let e=new URLSearchParams(Object.keys(t).map(e=>[e,t[e].toString()])),n="".concat(i,"?").concat(e.toString());a.push(n)}},n),{id:o,"data-id":o,children:c}))}var eG=n(24048),eD=n(12066);function eL(e){let{actionData:t}=e,n=(0,b.useContext)(c.ActionListContext),i=eG.Gh[t.type];return(0,r.jsxs)(eD.A,{sx:{position:"relative",padding:"2px",marginTop:"2px",marginBottom:"2px","&::after":{content:'""',position:"absolute",right:0,top:"5px",bottom:"5px",borderRight:"1px solid red"},"&::before":{content:'""',position:"absolute",left:0,top:"5px",bottom:"5px",borderLeft:"1px solid red"}},children:[i.UI(t),(0,r.jsx)(eD.A,{sx:{textAlign:"center"},children:(0,r.jsx)(ef.b,{title:"删除动作",content:"确定删除本动作吗？",onConfirm:function(){let e=n.indexOf(t);-1!==e&&n.splice(e,1)},children:(0,r.jsx)(y.A,{id:"del-action-btn","data-id":"del-action-btn",children:"删除"})})})]})}function eM(){let e=(0,b.useContext)(c.ActionGroupContext),[t]=ej(e.list);return t&&K().isArray(t)||console.log("lllllllllllllist is null",e),console.log("list updated"),(0,r.jsx)("div",{children:e.list.map(e=>(0,r.jsx)(eL,{actionData:e},Y(e).key))})}function e_(e){let{actionGroup:t}=e,{t:n}=(0,R.useTranslation)("droid-project/project/ui/project/edit-project/trigger-action-group/trigger-action/action-group/content"),i=(0,b.useContext)(W),o=(0,b.useContext)(c.TriggerActionGroupContext),a=(0,b.useContext)(c.TriggerActionContext),s={projectId:i.project.id,triggerActionGroupId:o.id,triggerActionId:a.id,actionGroupId:t.id,type:ec.ActionOrTriggerListTypeEnum.addAction,actionType:""},[l]=(0,d.x)(t,"isSequential",t.isSequential),[p]=(0,d.x)(t.list,"length",t.list.length);return(0,r.jsx)(c.ActionGroupContext.Provider,{value:t,children:(0,r.jsx)(c.ActionListContext.Provider,{value:t.list,children:(0,r.jsxs)(P.A,{sx:{border:"2px solid #ccc",padding:"4px"},children:[(0,r.jsxs)(ei.A,{container:!0,sx:{alignItems:"center"},children:[(0,r.jsx)(ei.A,{size:"grow",children:(0,r.jsx)(P.A,{children:n("content.title")})}),(0,r.jsx)(ei.A,{children:p>1&&(0,r.jsx)(ea.A,{children:(0,r.jsx)(es.A,{control:(0,r.jsx)(el.A,{checked:l,"data-id":"action-group-checkbox-is-sequential.122f","aria-checked":l,"data-checked":l,onChange:e=>{var n;n=e.target.checked,(0,g.I$)(t).isSequential=n}}),label:n("content.sequential")})})}),(0,r.jsx)(ei.A,{children:(0,r.jsx)(P.A,{children:(0,r.jsx)(eO,{query:s,attrs:(0,X.q_)(t),path:"/action-list",btnId:"link-router-to-action-list",children:n("content.list")})})})]}),(0,r.jsx)(eb,{group:t}),(0,r.jsx)(eM,{})]})})})}var eB=n(56700);function eK(e){let{triggerData:t}=e,n=(0,b.useContext)(c.TriggerListContext),i=(0,eB.gq)(t.type);return(0,r.jsx)(c.TriggerContext.Provider,{value:t,children:(0,r.jsxs)(P.A,{children:[i.UI(t),(0,r.jsx)(P.A,{sx:{textAlign:"center"},children:(0,r.jsx)(ef.b,{title:"删除触发",content:"确定删除本触发吗？",onConfirm:()=>{let e=n.indexOf((0,g.I$)(t));-1!==e&&(0,g.I$)(n).splice(e,1)},children:(0,r.jsx)(D.A,{id:"del-trigger-btn","data-id":"del-trigger-btn",children:"删除"})})})]})})}function eq(){let e=(0,b.useContext)(c.TriggerGroupContext),[t]=ej(e.list);return(0,r.jsx)(c.TriggerListContext.Provider,{value:e.list,children:(0,r.jsx)(P.A,{children:e.list.map(e=>(0,r.jsx)(eK,{triggerData:e},Y(e).version))})})}function eN(e){let{triggerGroup:t}=e,{t:n}=(0,R.useTranslation)("droid-project/project/ui/project/edit-project/trigger-action-group/trigger-action/trigger-group/content"),i=(0,b.useContext)(W),o=(0,b.useContext)(c.TriggerActionGroupContext),a=(0,b.useContext)(c.TriggerActionContext),s={projectId:i.project.id,triggerActionGroupId:o.id,triggerActionId:a.id,triggerGroupId:t.id,type:ec.ActionOrTriggerListTypeEnum.addAction,actionType:""},[l]=(0,d.x)(t,"isSequential",t.isSequential),[p]=(0,d.x)(t.list,"length",t.list.length);return(0,r.jsx)(c.TriggerGroupContext.Provider,{value:t,children:(0,r.jsxs)(P.A,{sx:{border:"2px solid #a4a737",padding:"4px",marginBottom:"2px",marginTop:"2px"},children:[(0,r.jsxs)(ei.A,{container:!0,sx:{alignItems:"center"},children:[(0,r.jsx)(ei.A,{size:"grow",children:(0,r.jsx)(P.A,{children:n("content.title")})}),(0,r.jsx)(ei.A,{children:p>1&&(0,r.jsx)(ea.A,{children:(0,r.jsx)(es.A,{control:(0,r.jsx)(el.A,{checked:l,"data-id":"trigger-group-checkbox-is-sequential.122f","aria-checked":l,"data-checked":l,onChange:e=>{var n;n=e.target.checked,(0,g.I$)(t).isSequential=n}}),label:n("content.sequential")})})}),(0,r.jsx)(ei.A,{children:(0,r.jsx)(P.A,{children:(0,r.jsx)(eO,{query:s,attrs:X.mR.triggerGroup.getTriggerGroupElement(t),path:"/trigger-list",btnId:"link-router-to-trigger-list",children:n("content.list")})})})]}),(0,r.jsx)(eb,{group:t}),(0,r.jsx)(eq,{})]})})}function eR(e){let{triggerAction:t}=e,[n,i]=(0,b.useState)(t.name||"未命名");return(0,r.jsx)(c.TriggerActionContext.Provider,{value:t,children:(0,r.jsxs)(P.A,{sx:{border:"2px solid #02450e",padding:"4px"},"data-id-trigger-action":t.id,children:[(0,r.jsxs)(ei.A,{sx:{alignItems:"center"},container:!0,children:[(0,r.jsxs)(ei.A,{children:[(0,r.jsx)(en.A,{}),(0,r.jsx)(et.A,{})]}),(0,r.jsx)(ei.A,{size:"grow",children:(0,r.jsx)(v,{setText:function(e){t.name=e,i(e)},children:(0,r.jsx)("span",{"data-id":"rename-trigger-action-btn.a4c6",children:n})})}),(0,r.jsx)(ei.A,{children:(0,r.jsx)(ef.b,{title:"提示",content:"确认要删除这条触发器和动作吗",onConfirm:function(){let e=(0,u.SZ)(t);e&&e.splice(e.indexOf(t),1)},children:(0,r.jsx)(E.A,{"data-id":"del-trigger-action-btn",children:(0,r.jsx)(eo.A,{})})})})]}),(0,r.jsx)(eN,{triggerGroup:t.triggerGroup}),(0,r.jsx)(e_,{actionGroup:t.actionGroup})]})})}var eU=Object.defineProperty,e$=Object.defineProperties,ez=Object.getOwnPropertyDescriptors,eF=Object.getOwnPropertySymbols,eJ=Object.prototype.hasOwnProperty,eW=Object.prototype.propertyIsEnumerable,eV=(e,t,n)=>t in e?eU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eX=(e,t)=>{for(var n in t||(t={}))eJ.call(t,n)&&eV(e,n,t[n]);if(eF)for(var n of eF(t))eW.call(t,n)&&eV(e,n,t[n]);return e},eH=(e,t)=>e$(e,ez(t));function eZ(){let{t:e}=(0,k.Bd)("droid-project/project/ui/project/edit-project/trigger-action-group/content"),t=(0,b.useContext)(W),[n,i]=(0,b.useState)(t.project.triggerActionGroup.name||e("TriggerActionGroup.unamed")),[o]=function(e){let[t,n]=(0,b.useState)([...e]),r=(0,g.Ax)(e).addListener(H._l,()=>{n([...e])});return(0,b.useEffect)(()=>()=>{r()},[]),[t,r]}(t.project.triggerActionGroup.list),a=t.project.triggerActionGroup;return(0,r.jsx)(c.TriggerActionGroupContext.Provider,{value:a,children:(0,r.jsxs)(P.A,eH(eX({sx:{border:"2px solid rgb(217, 217, 217)",padding:"4px"}},X.mR.triggerActionGroup.getTriggerActionGroupElementByProp(a.list)),{"data-id-trigger-action-group":a.id,children:[(0,r.jsxs)(ei.A,{container:!0,sx:{alignItems:"center"},children:[(0,r.jsxs)(ei.A,{container:!0,sx:{alignItems:"center"},children:[(0,r.jsx)(en.A,{}),(0,r.jsx)(et.A,{}),(0,r.jsx)(er.A,{})]}),(0,r.jsx)(ei.A,{size:"grow",sx:{alignItems:"center",width:"100%"},children:(0,r.jsx)(P.A,{sx:{width:"100%"},children:(0,r.jsx)(v,{setText:function(n){t.project.triggerActionGroup.name=n,i(n||e("TriggerActionGroup.unamed"))},children:(0,r.jsx)("span",{"data-id":"rename-groupname-btn-a322",style:{backgroundColor:"red"},children:n})})})}),(0,r.jsx)(ei.A,{children:(0,r.jsx)(P.A,{children:(0,r.jsx)(E.A,{"data-id":"add-trigger-action-btn.22fab779-75e2-4e34-82f4-64667e7fc017",onClick:function(){let e=(0,V.n)();(0,u.sd)(a).list.push(e)},children:(0,r.jsx)(ee.A,{})})})})]}),(0,r.jsx)(P.A,{children:o.map((e,t)=>{let n=a.list[t];return(0,r.jsx)(eR,{triggerAction:n},Y(n).version)})})]}))})}var eQ=n(34552);let eY=(0,w.Ay)(T.A)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function e0(){let e=(0,b.useContext)(c.ProjectContext);return(0,r.jsx)(P.A,{"data-id-project":e.id,children:(0,r.jsx)(I.A,{children:(0,r.jsx)(eZ,{})})})}function e1(){let e=(0,b.useContext)(W),t=l.tG.createCountedLogger(!1,"project-editor-effect"),[n]=(0,d.x)(e,"askStay",e.askStay),i=(0,L.useRouter)();function o(){e.askStay=!1,e.giveup=!0,i.back(),e.giveup=!1,e.updated=!1}function c(){e.askStay=!1}return(0,r.jsx)(P.A,{children:(0,r.jsxs)(eY,{onClose:c,"aria-labelledby":"customized-dialog-title",open:n,children:[(0,r.jsx)(S.A,{sx:{m:0,p:2},id:"customized-dialog-title",children:"提示:您有更改没有保存，确定要离开吗？"}),(0,r.jsx)(E.A,{"aria-label":"close",onClick:c,sx:e=>({position:"absolute",right:8,top:8,color:e.palette.grey[500]}),children:(0,r.jsx)(C.A,{})}),(0,r.jsx)(O.A,{dividers:!0}),(0,r.jsxs)(G.A,{children:[(0,r.jsx)(D.A,{onClick:function(){o(),a.D.deleteDraft(e.project.id)},children:"放弃保存并离开"}),(0,r.jsx)(D.A,{onClick:function(){a.D.addDraft(e.project),o()},children:"保存变更到草稿并离开"}),(0,r.jsx)(D.A,{onClick:function(){e.save(),o(),a.D.deleteDraft(e.project.id)},children:"保存并离开"}),(0,r.jsx)(D.A,{onClick:function(){e.askStay=!1,e.giveup=!1,t.log("handleStayAndEdit fn called ","objectCount=",p._.getObjectCount(e),"editInfo=",e)},children:"留下编辑"})]})]})})}var e2=n(75936),e5=n(73256),e7=n(33218),e4=n(20017);function e8(){let{Content:e,Title:t,dispatcher:n}=function(){let e=new i.m,{id:t}=(0,L.useRouter)().query,n=a.D.findDraftOrSavedProject(t||"-1")||(0,s.D)({id:t||"-1"}),p=n,h=n=a.D.addDraft(p),j=n=(0,g.I$)(h),f=n=(0,u.sd)(j),m=J.edit(f);function A(){let e=new l.tG(!1,"checkUpdated_fn");e.isPaused=!0;let t=a.D.findSavedProject(n.id);return(e.log("checkUpdated fn called","c=",t),m.updated=!t||!K().isEqual(t,n),e.log("editInfo.updated=",m.updated),m.updated&&!m.giveup)?(m.askStay=!0,e.log("checkUpdated fn called","editInfo.askStay=",m.askStay),!0):(e.log("checkUpdated fn called2","editInfo.askStay=",m.askStay),!1)}return{Content:function(){(0,b.useEffect)(()=>{if(N(n),!n)return;let e=(0,x.c)((0,u.Al)(n),()=>{N(n),m.updated=!0});return()=>{e()}},[]),(0,b.useEffect)(()=>{let e=o.addListener("checkBrowserCanBack",e=>{let t=e.result=A();console.log("ooooooooooooooooooooooooo checkBrowserCanBack_fn",e,"canback=",t),t&&a.D.deleteDraft(n.id)});return()=>{e()}},[]),(0,b.useEffect)(()=>e.addListener("back",e=>{(e.defaultPrevented=A())&&a.D.deleteDraft(n.id)}),[]);let t=(0,g.I$)(m.project);return(0,r.jsx)(W.Provider,{value:m,children:(0,r.jsx)(c.ProjectContext.Provider,{value:t,children:(0,r.jsxs)(P.A,{children:[(0,r.jsx)(e0,{}),(0,r.jsx)(e1,{})]})})})},Title:function(){let{t:e}=(0,k.Bd)("droid-project/project/ui/project/edit-project/content"),t=e("content.clickToSetProjectName"),[i]=(0,d.x)(n,"name",t);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:16,width:"100%",alignItems:"center"},children:[(0,r.jsx)("span",{style:{flexGrow:1,paddingLeft:"2rem"},children:(0,r.jsx)(v,{setText:function(e){n.name=e},children:(0,r.jsx)("h2",{children:(0,r.jsx)("span",{id:"project-name-editor","data-id":"project-name-editor",children:i||t})})})}),(0,r.jsx)(E.A,{onClick:()=>{m.save()},children:(0,r.jsx)(eQ.A,{})})]})},dispatcher:e}}();(0,e7.v)(),(0,e4.J)();let p={title:(0,r.jsx)(t,{}),back:!0,backDispatcher:n};return(0,r.jsx)(e2.G,{children:(0,r.jsx)(e5.W,{appbarProps:p,titleConf:{ns:"homepage/pages/project-editor/content",key:"editor.title"},children:(0,r.jsx)(e,{})})})}},58553:(e,t,n)=>{"use strict";n.d(t,{b:()=>p});var r=n(50612),i=n(36734),o=n(38212),c=n(80740),a=n(22066),s=n(94011),l=n(94344),d=n(7843);function p(e){let{title:t,content:n,confirmText:p,cancelText:g,onConfirm:u,onCancel:x,onClose:h,cancelId:j,confirmId:f,children:m}=e,[A,y]=(0,l.useState)(!1),{t:b}=(0,d.Bd)("fanfanlo/mui/dialog/content");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{onClick:()=>y(!0),children:m}),(0,r.jsxs)(i.A,{open:A,onClose:()=>y(!1),children:[(0,r.jsx)(o.A,{children:t||b("ButtonConfirm.title")}),(0,r.jsx)(c.A,{children:n||b("ButtonConfirm.content")}),(0,r.jsxs)(a.A,{children:[(0,r.jsx)(s.A,{id:j||"btn-dialog-button-confirm-cancel","data-id":j||"btn-dialog-button-confirm-cancel",onClick:()=>{y(!1),null==x||x(),null==h||h(!1)},children:g||b("ButtonConfirm.cancel")}),(0,r.jsx)(s.A,{id:f||"btn-dialog-button-confirm-confirm","data-id":f||"btn-dialog-button-confirm-confirm",onClick:()=>{y(!1),null==u||u(),null==h||h(!0)},children:p||b("ButtonConfirm.confirm")})]})]})]})}},7843:(e,t,n)=>{"use strict";n.d(t,{Bd:()=>r.Bd});var r=n(4216)}},e=>{var t=t=>e(e.s=t);e.O(0,[955,602,852,362,250,136,737,357,249,264,103,434,636,593,792],()=>t(43932)),_N_E=e.O()}]);