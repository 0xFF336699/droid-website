{"version":3,"file":"static/chunks/pages/markets-dev-settings-0c2501e64ef0dc51.js","mappings":"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","sources":["webpack://_N_E/./src/markets/market-dev-socket-setting-data.ts","webpack://_N_E/./src/markets/markets-script-dev-lib.ts","webpack://_N_E/../../../src/types/market.intf.ts","webpack://_N_E/../../../src/watcher/useWatchUpdates.tsx","webpack://_N_E/../../../../src/utils/socket/socket-utils.ts","webpack://_N_E/?29aa","webpack://_N_E/./src/markets/market-dev-socket.ts","webpack://_N_E/../../../../src/components/app/AppPageDataWrapperShell.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/data/context.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/DevSettings.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/Scripts.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/content/MarketsDevSettingsContent.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/data/data.intf.ts","webpack://_N_E/./src/pages/markets-dev-settings/index.tsx"],"sourcesContent":["import { storeUtils, toProxy } from \"@fanfanlo\";\r\n\r\nexport interface ISocketSettingData{\r\n    //如果点击开始链接了，那就保持链接，这样需要注意不在开发环境时会不停重连。\r\n    keepConnect:boolean;\r\n    url:string;\r\n}\r\n\r\nasync function createDefSocketSettingData():Promise<ISocketSettingData>{\r\n    const data =  {\r\n        keepConnect:false,\r\n        url:\"\"     \r\n     }\r\n     const res = await storeUtils.getNamespaceStoreWithData('market-dev-socket-setting', {defData:data})\r\n     return res.data;\r\n}\r\n\r\nexport async function getMarketDevSocketSettingData():Promise<ISocketSettingData>{\r\n    return await createDefSocketSettingData()\r\n}","import { autoJsStoreUtils } from \"@droid/android\"\r\nimport { IStoreWithData, storeUtils, toProxy } from \"@fanfanlo\"\r\nimport { IAndroidWatchFile, IMarketDevConnectEventType, IMarketDevGetAllEventData, IMarketDevServerEventType, WatchResourceType } from \"@market/lib\"\r\nimport { marketsDevSocket } from \"./market-dev-socket\"\r\nimport { objectCountUtils } from \"@fanfanlo\"\r\ninterface IMarketDevLibInfo{\r\n    allMarketLibData?:IMarketDevGetAllEventData\r\n    \r\n}\r\n// 注意marketDevLibData的操作是由devLibInfo来做的\r\n// 一定保持它俩操作的对象是同一个。\r\nconst marketDevLibData = toProxy<IMarketDevLibInfo>({})\r\nlet devLibInfo:IStoreWithData<IMarketDevLibInfo>// = storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n\r\nfunction getMarketScriptDataNsPrefix() {\r\n    return 'market-script-data'\r\n}\r\n\r\nfunction createMarketScriptDataNsPath(ns: string) {\r\n    return `${getMarketScriptDataNsPrefix()}/${ns}`\r\n}\r\n\r\nasync function writeNsAllFiles(ns: string, files: Record<string, string>) {\r\n    const nsPath = createMarketScriptDataNsPath(ns)\r\n    const oldFiles = autoJsStoreUtils.read<string[]>(nsPath) || [];\r\n    for (const name of Object.keys(files)) {\r\n        const index = oldFiles.indexOf(name);\r\n        if (index > -1) {\r\n            oldFiles.splice(index, 1);\r\n        }\r\n        const content = files[name]\r\n        autoJsStoreUtils.write(`${nsPath}/${name}`, content)\r\n    }\r\n    for (const name of oldFiles) {\r\n        removeFile(`${nsPath}/${name}`)\r\n    }\r\n}\r\n\r\nfunction writeFile(name: string, content: string) {\r\n\r\n}\r\n\r\nfunction readNsAllFiles(ns: string) {\r\n\r\n}\r\n\r\nfunction readFile(name: string) {\r\n\r\n}\r\n\r\nfunction removeFile(name: string) {\r\n\r\n}\r\n\r\nfunction getAllMarkets() {\r\n\r\n}\r\nfunction listenDev(){\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevConnectEventType.getAllScripts, onGetAllScript)\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevServerEventType.update, onFileUpdate)    \r\n}\r\n\r\nfunction onGetAllScript(data:IMarketDevGetAllEventData){\r\n    // console.log('onGetAllScript=2', data)\r\n    // console.log('devLibInfo.data=', devLibInfo.data)\r\n    devLibInfo.data.allMarketLibData = data;\r\n    // 转为已经代理过的对象\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData;\r\n    // console.log('from onGetAllScript look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources))\r\n}\r\n\r\nfunction onFileUpdate(data:IAndroidWatchFile){\r\n    if(data.client.resourceType == WatchResourceType.Html){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(const html of devLibInfo.data.allMarketLibData.htmls){\r\n            if(html.client.path == data.client.path){\r\n                html.content = data.content;\r\n                return;\r\n            }\r\n        }\r\n    }else if(data.client.resourceType == WatchResourceType.Js){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(let index = 0; index < devLibInfo.data.allMarketLibData.resources.length; index ++){\r\n            const script = devLibInfo.data.allMarketLibData.resources[index];\r\n            if(script.client.path == data.client.path){\r\n                devLibInfo.data.allMarketLibData.resources[index] = data;\r\n                // devLibInfo.data.allMarketLibData.resources = [...devLibInfo.data.allMarketLibData.resources];\r\n                // console.log('update data', data);\r\n                // console.log('look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources), devLibInfo.data.allMarketLibData.resources)\r\n                return;\r\n            }\r\n        }\r\n    }else{\r\n        // unknown resource type\r\n    }\r\n}\r\nlet isInitialized = false;\r\nasync function init() {\r\n    if(isInitialized){\r\n        return;\r\n    }\r\n    isInitialized = true;\r\n    listenDev();\r\n    devLibInfo = await storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData\r\n    console.log('devLibInfo.data bbbb=', devLibInfo.data)\r\n}\r\nexport const marketsDevScriptLib = {\r\n    writeFile,\r\n    readFile,\r\n    writeNsAllFiles,\r\n    readNsAllFiles,\r\n    getAllMarkets,\r\n    init,\r\n    marketDevLibData,\r\n}\r\n","export enum ScriptType {\r\n    // 只有一个脚本执行文件，它只在脚本列表里显示。\r\n    // 如果要修改或者配置参数，它可以嵌入到自己的代码里\r\n    // 或者提供新的页面路径，用router的方式打开\r\n    // 例如router.go({url:'/script-setting', script:'function(){//code is here}', pagePath:'/all-script-setting/#your-namespace/script/script001'})\r\n    // all-script-setting所有第三方统一页面\r\n    // your-namespace 第三方自己的命名空间\r\n    // url 第三方自己的js文件url，它和script二选一，优先script。\r\n    // script 第三方自己纯代码的脚本\r\n    // url可以设置为实时更新版本，script可以作为stable版本使用。\r\n    // script001 第三方自己的脚本名称\r\n    // pagePath可以挂载到你指定的路径下\r\n    Script = 'script',\r\n    Market = 'market'\r\n}\r\nexport enum WatchResourceType {\r\n    // 这是一个js文件，加载后直接套在iframe里用即可\r\n    Js = 'js',\r\n    // 这是一个html文件，直接当html加载到iframe里即可.\r\n    Html = 'html'\r\n}\r\n\r\nexport enum IMarketDevConnectEventType{\r\n    getAllScripts = 'getAllScripts'\r\n}\r\n// client用socket向server发送的消息，也就是安卓端或者是安卓端的网页向server发送的消息\r\nexport enum IMarketDevClientEmitEventType{\r\n    init = 'init'\r\n}\r\n// server用socket向安卓端发送的消息（本地调试也可以认为是向安卓的网页发送消息）\r\nexport enum IMarketDevServerEventType{\r\n    update = 'update',\r\n}\r\n\r\n// export interface IMarketDevFileUpdateEventData{\r\n//     filePath:string,\r\n//     conf:IClientWatchFile\r\n// }\r\n\r\nexport interface IMarketDevFileUpdateEvent extends IMarketDevEvent<IAndroidWatchFile>{\r\n    type: IMarketDevServerEventType.update,\r\n    data:IAndroidWatchFile\r\n}\r\n\r\nexport interface IMarketDevGetAllEventData{\r\n    resources:IAndroidWatchFile[]\r\n    htmls:IAndroidWatchFile[]\r\n}\r\nexport interface IMarketDevGetAllEvent extends IMarketDevEvent<IMarketDevGetAllEventData>{\r\n    type: IMarketDevConnectEventType.getAllScripts,\r\n    data:IMarketDevGetAllEventData\r\n}\r\nexport type IMarketDevEventType = IMarketDevConnectEventType | IMarketDevClientEmitEventType | IMarketDevServerEventType;\r\nexport interface IMarketDevEvent<T>{\r\n    type: IMarketDevEventType,\r\n    data:T\r\n}\r\ntype NamespaceType = string;\r\nexport interface IScriptFile{\r\n\r\n    // 命名空间 用于识别唯一对象\r\n    // 每个用户用自己的用户名做命名空间\r\n    // 例如\r\n    // 0xFF336699/e-commerce\r\n    ns:NamespaceType\r\n    resourceType:WatchResourceType\r\n    scriptType:ScriptType\r\n    // 通过网络加载的路径\r\n    url?:string;\r\n}\r\n\r\nexport interface IClientWatchFile extends IScriptFile{\r\n    // 本地加载的路径\r\n    path:string;\r\n    //是否是ui模式输出，如果是ui模式输出则需要export {ScriptItem, MarketItem, MarketPage}当中之一或全部。\r\n    // isUi:boolean\r\n}\r\nexport interface IClientScriptConf extends IClientWatchFile{\r\n}\r\n\r\nexport interface IClientHtmlConf extends IClientWatchFile{\r\n    resourcesPath:string\r\n    resourcesUrl:string\r\n}\r\n\r\nexport interface IAndroidWatchFile{\r\n    client:IClientWatchFile\r\n    content:string\r\n}\r\n\r\n// 脚本文件map，这里是打散的，并没有按照开发者的ns分类，而是按照文件名分类\r\n// 也就是文件名当作分类了。开发者有个ns，但是一个开发者可以开发n个market\r\n// 所以用开发者的ns做限定是不够用的，现在想的是开发者ns+market or script做market的限定\r\n// 所以这个ns应该是：\r\n// `${developerNs}/markets/${market}`\r\n// `${developerNs}/markets/${market}/${script}`\r\n// `${developerNs}/scripts/${script}`\r\n// 这种格式，回头可以用分段的方式来截取对象\r\nexport type ScriptMap = Record<NamespaceType, IAndroidWatchFile>;","import _ from \"lodash\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { IWatchUpdatesConfig, watchUpdates } from \"./watchUpdates\"\r\nimport { PropertiesChain } from \"./proxyWatch\"\r\nimport { useProxyWatch } from \"./useProxyWatch\"\r\nimport { objectCountUtils } from \"../utils\"\r\n\r\n/**\r\n * \r\n * 注意，返回的无论是object还是array，都无法监听，因为它们不是proxy，而是原始对象的副本\r\n * @param target 要监听的对象\r\n * @param conf 监听配置\r\n * @returns 监听的对象\r\n */\r\nexport function useWatchUpdates<T extends object>(target: T, conf?: IWatchUpdatesConfig<T>):[T]{\r\n    const [value, setValue] = useState<T>(target)\r\n    useEffect(() => {\r\n        console.log('use watch updates look look id', objectCountUtils.getObjectCount(target))\r\n        watchUpdates(target, (info)=>{\r\n            console.log('uuuuuuuuuupdated', info)\r\n            console.log('tttttttarget=',target);\r\n            const now = _.isArray(info.target) ? [...info.target] : info.target\r\n            // setValue(now as T)\r\n            setValue((_.isArray(target) ? [...target ] : {...target}) as T)\r\n        }, conf)\r\n    }, [])\r\n    return [value as T]\r\n}\r\n\r\n/**\r\n * useProxyWatch + useWatchUpdates 结合体\r\n * 因为react的刷新机制，所以第二个state必须得用setState才会生效。\r\n * 不然其实这是两行代码，第一行是useProxyWatch，第二行是useWatchUpdates就可以了。\r\n * @param target 要监听的对象\r\n * @param propertyChain 要监听的属性链\r\n * @param defaultValue 默认值\r\n * @param conf 监听配置\r\n * @returns 监听的对象 返回的第一个参数是重新拼装的{...arr} or {...obj}，第二个参数是原始的target or defaultValue\r\n */\r\nexport function useProxyWatchUpdates<T extends object, U extends object>(target:T,\r\n  propertyChain: PropertiesChain<T>,\r\n  defaultValue: U,\r\n  conf?: IWatchUpdatesConfig<U> ):[U, U]{\r\n    const [v] = useProxyWatch(target, propertyChain, defaultValue)\r\n    const [value, setValue] = useState<U>(defaultValue)\r\n    useEffect(() => {\r\n        watchUpdates(v, (info)=>{\r\n            setValue((_.isArray(v) ? [...v ] : {...v}) as U)\r\n        }, conf)\r\n    }, [v])\r\n    return [value, v]\r\n  }","import validator from \"validator\";\r\nimport { loadI18nValue } from \"../../i18n\";\r\nexport function isValidWebSocketURL(url: string): boolean {\r\n    return validator.isURL(url, { protocols: ['ws','wss'], require_protocol: true });\r\n  }\r\n  \r\n\r\nexport enum SocketConnectStatusEnum {\r\n    connecting = \"connecting\",\r\n    connected = \"connected\",\r\n    disconnecting = \"disconnecting\",\r\n    disconnected = \"disconnected\",\r\n    waitRetry = \"waitRetry\"\r\n}\r\n\r\nexport async function getSocketConnectStatusEnumI18n(status:SocketConnectStatusEnum){\r\n    return await loadI18nValue('fanfanlo/utils/socket/content', `status.${status}`);\r\n}","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/markets-dev-settings\",\n      function () {\n        return require(\"private-next-pages/markets-dev-settings/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/markets-dev-settings\"])\n      });\n    }\n  ","import { Dispatcher, isValidWebSocketURL, SocketConnectStatusEnum, toProxy } from \"@fanfanlo\";\r\nimport { IMarketDevConnectEventType, IMarketDevEvent } from \"@market/lib\";\r\nimport { getMarketDevSocketSettingData } from \"./market-dev-socket-setting-data\";\r\nconst dispatcher = new Dispatcher();\r\ninterface ISocketConnectInfo{\r\n    status:SocketConnectStatusEnum;\r\n    retryCount:number;\r\n}\r\n\r\nexport const socketConnectInfo:ISocketConnectInfo = toProxy({\r\n    status:SocketConnectStatusEnum.disconnected,\r\n    retryCount:0\r\n})\r\nlet ws:WebSocket|undefined;\r\nasync function connect(){\r\n    const url = (await getMarketDevSocketSettingData()).url\r\n    if(!isValidWebSocketURL(url)){\r\n        return;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.connecting;\r\n    const w = ws = new WebSocket(url);\r\n    w.onopen = () => {\r\n        socketConnectInfo.status = SocketConnectStatusEnum.connected;\r\n        toGetAllScripts();\r\n    }\r\n    w.onclose = () => {\r\n        console.log('oscket on close', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        checkNeedRetry();\r\n    }\r\n    w.onerror = () => {\r\n        console.log('socket onerror', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        close();\r\n        checkNeedRetry();\r\n    }\r\n    w.onmessage = (e:MessageEvent) => {\r\n        try{\r\n            const event:IMarketDevEvent<any> = JSON.parse(e.data)\r\n            dispatcher.dispatch(event.type, event.data)\r\n        }catch(e){\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    async function toGetAllScripts(){\r\n        const event = {type: IMarketDevConnectEventType.getAllScripts}\r\n        w.send(JSON.stringify(event));\r\n    }\r\n}\r\nfunction close(){\r\n    if(!ws)return;\r\n    ws.close();\r\n    ws = undefined;\r\n}\r\nasync function checkNeedRetry(){\r\n    const settingData = await getMarketDevSocketSettingData()\r\n    if(!settingData.keepConnect){\r\n        return;\r\n    }\r\n    socketConnectInfo.retryCount++;\r\n    setTimeout(()=>{\r\n        connect();\r\n    }, 1000 * 5)\r\n}\r\nfunction disconnect(){\r\n    if(ws){\r\n        ws.close();\r\n        ws = undefined;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n}\r\nexport const marketsDevSocket = {\r\n    connect,\r\n    disconnect,\r\n    socketConnectInfo,\r\n    dispatcher\r\n}\r\n","import { PropsWithChildren } from \"react\";\r\nimport { AppShell } from \"./AppShell\";\r\nimport { ContextWrapper, ContextWrapperProps } from \"@fanfanlo\";\r\n\r\n//回头想想AppShell里的s要怎么用\r\n// createTypedContext方法返回的context没想好怎么样跟s结合使用。\r\n\r\nexport function AppPageDataWrapperShell<T>({ children, contextValue, ContextProvider }: PropsWithChildren & ContextWrapperProps<T>) {\r\n    return (\r\n        <AppShell>\r\n            <ContextWrapper contextValue={contextValue} ContextProvider={ContextProvider}>\r\n                {children}\r\n            </ContextWrapper>\r\n        </AppShell>\r\n    )\r\n}","import { createTypedContext } from \"@fanfanlo\";\r\nimport { IPageData } from \"./data.intf\";\r\n\r\nexport const [MarketsDevSettingsContextProvider, useMarketsDevSettingsContext] = createTypedContext<IPageData>();","'use client'\r\nimport { getSocketConnectStatusEnumI18n, isValidWebSocketURL, SocketConnectStatusEnum, useProxyWatch, useTranslation } from \"@fanfanlo\";\r\nimport { Box, Button, Checkbox, FormControlLabel, Grid2, Stack, TextField } from \"@mui/material\";\r\nimport { marketsDevSocket } from \"@src/markets/market-dev-socket\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useMarketsDevSettingsContext } from \"../data/context\";\r\n\r\nfunction URL() {\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [value, _setValue] = useState(pageData.socketSettingData.url)\r\n    const [isWrong, setIsWrong] = useState(!isValidWebSocketURL(value))\r\n    function setValue(v: string) {\r\n        _setValue(v)\r\n        pageData.socketSettingData.url = v\r\n        if (!isValidWebSocketURL(v)) {\r\n            setIsWrong(true)\r\n        } else {\r\n            setIsWrong(false)\r\n        }\r\n    }\r\n    const s = t(\"DevSettings.socket.url.helperText\", { 0: \"socket\", 1: \"ws\", 2: \"wss\", 3: \"url\" })\r\n    return (\r\n        <Box>\r\n            <TextField fullWidth\r\n                error={isWrong}\r\n                label={t(\"DevSettings.socket.url.name\")}\r\n                value={value}\r\n                placeholder={\"ws://192.168.1.2:7001\"}\r\n                helperText={isWrong ? s : \"\"}\r\n                variant=\"standard\"\r\n                onChange={(e) => setValue(e.target.value)}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nfunction ConnectButton2() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [status] = useProxyWatch(marketsDevSocket.socketConnectInfo, 'status', marketsDevSocket.socketConnectInfo.status);\r\n    const [buttonName, setButtonName] = useState('')\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    const [url] = useProxyWatch(pageData.socketSettingData, 'url', pageData.socketSettingData.url);\r\n    const [enabled, setEnabled] = useState(false)\r\n    useEffect(() => {\r\n        setEnabled((status === SocketConnectStatusEnum.disconnected || status === SocketConnectStatusEnum.connected) && isValidWebSocketURL(url))\r\n    }, [status, url])\r\n    useEffect(() => {\r\n        async function updateButtonName() {\r\n            const status = marketsDevSocket.socketConnectInfo.status\r\n            let name = buttonName;\r\n\r\n            switch (status) {\r\n                case SocketConnectStatusEnum.connecting:\r\n                    name = await getSocketConnectStatusEnumI18n(SocketConnectStatusEnum.connecting)\r\n                    break;\r\n                case SocketConnectStatusEnum.connected:\r\n                    name = t(\"DevSettings.connectButton.disconnect\")\r\n                    break;\r\n                case SocketConnectStatusEnum.disconnecting:\r\n                    name = await getSocketConnectStatusEnumI18n(SocketConnectStatusEnum.disconnecting)\r\n                    break;\r\n                case SocketConnectStatusEnum.disconnected:\r\n                    name = t(\"DevSettings.connectButton.connect\")\r\n                    break;\r\n            }\r\n            if(marketsDevSocket.socketConnectInfo.status !== status){\r\n                return updateButtonName();\r\n            }\r\n            if(name !== buttonName){\r\n                setButtonName(name)\r\n            }\r\n        }\r\n        updateButtonName()\r\n    }, [status])\r\n    function onClick() {\r\n        if (status === SocketConnectStatusEnum.disconnected) {\r\n            marketsDevSocket.connect();\r\n        } else {\r\n            marketsDevSocket.disconnect();\r\n        }\r\n    }\r\n    return (\r\n        <Button\r\n            variant=\"contained\"\r\n            disabled={!enabled}\r\n            onClick={onClick}\r\n        >\r\n            {buttonName}\r\n        </Button>\r\n    )\r\n}\r\n\r\nfunction KeepConnectCheckbox() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    const [keepConnect] = useProxyWatch(pageData.socketSettingData, 'keepConnect', pageData.socketSettingData.keepConnect ?? false);\r\n    const { t } = useTranslation('homepage/components/page/markets-dev-settings/content/content');\r\n    return (\r\n        \r\n        <FormControlLabel control={<Checkbox\r\n            checked={keepConnect}\r\n            onChange={(e) => pageData.socketSettingData.keepConnect = e.target.checked}\r\n        />}\r\n            label={<span><span>{t(\"DevSettings.socket.keepConnect.name\")}</span><span style={{fontSize:'0.8rem', color:'gray'}}>{t(\"DevSettings.socket.keepConnect.helperText\")}</span></span>}>\r\n\r\n        </FormControlLabel>\r\n    )\r\n}\r\n\r\nfunction CheckboxButtonGroup() {\r\n    return (\r\n        <Grid2 container direction={\"row\"} spacing={2}>\r\n            <Grid2 size={\"grow\"}>\r\n                <KeepConnectCheckbox />\r\n            </Grid2>\r\n            <Grid2 size={\"auto\"}>\r\n                <ConnectButton2 />\r\n            </Grid2>\r\n        </Grid2>\r\n    )\r\n}\r\n\r\nexport function DevSettings() {\r\n    const pageData = useMarketsDevSettingsContext()\r\n    useEffect(() => {\r\n        if(pageData.socketSettingData.keepConnect){\r\n            marketsDevSocket.connect();\r\n        }\r\n    }, [])\r\n    return (\r\n        <>\r\n            <Box>\r\n                <Stack direction={\"column\"} spacing={2}>\r\n                    <URL />\r\n                    <CheckboxButtonGroup />\r\n                </Stack>\r\n            </Box>\r\n        </>\r\n    )\r\n}","import { IFrameReactContainer, objectCountUtils, useProxyWatch, useProxyWatchUpdates, useWatchUpdates, watchUpdates } from \"@fanfanlo\";\r\nimport { IAndroidWatchFile } from \"@market/lib\";\r\nimport { Box, Stack } from \"@mui/material\";\r\nimport { marketsDevScriptLib } from \"@src/markets/markets-script-dev-lib\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\n\r\nfunction createHtml(script:string){\r\n    return `<html>\r\n    <head>\r\n        <title>script</title>\r\n    </head>\r\n    <body>\r\n        <div id=\"app\"></div>\r\n        <script>${script}</script>\r\n    </body>\r\n</html>`\r\n}\r\nfunction Script({resource}:{resource:IAndroidWatchFile}){\r\n    return(\r\n        <Box>\r\n            <Stack direction=\"column\" spacing={2}>\r\n                <span>{resource.client.path}</span>\r\n                <IFrameReactContainer content={createHtml(resource.content)} />\r\n            </Stack>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport function Scripts(){\r\n    const [resources] = useProxyWatchUpdates(marketsDevScriptLib.marketDevLibData, \"allMarketLibData.resources\", marketsDevScriptLib.marketDevLibData.allMarketLibData?.resources || []);\r\n    return(\r\n        <Box>\r\n            {\r\n                marketsDevScriptLib.marketDevLibData.allMarketLibData?.resources?.map((resource, index)=>{\r\n                    return(\r\n                        <Script key={resource.content} resource={resource} />\r\n                    )\r\n                })\r\n            }\r\n        </Box>\r\n    )\r\n}","import { Box } from \"@mui/material\";\r\nimport { DevSettings } from \"./DevSettings\";\r\nimport { Scripts } from \"./Scripts\";\r\n\r\n\r\n\r\n\r\nexport function MarketsDevSettingsContent(){\r\n    return(\r\n        <>\r\n            <Box>\r\n                <DevSettings />\r\n                <Scripts />\r\n                <Box>\r\n                    <button>hello</button>\r\n                </Box>\r\n            </Box>\r\n        </>\r\n    )\r\n}","import { toProxy } from \"@fanfanlo\";\r\nimport { getMarketDevSocketSettingData } from \"@src/markets/market-dev-socket-setting-data\";\r\n\r\nexport interface ISocketSettingData{\r\n    //如果点击开始链接了，那就保持链接，这样需要注意不在开发环境时会不停重连。\r\n    keepConnect:boolean;\r\n    url:string;\r\n}\r\n\r\nexport interface IPageData{\r\n    socketSettingData:ISocketSettingData;\r\n}\r\n\r\nasync function createDefPageData():Promise<IPageData>{\r\n    return {\r\n        socketSettingData:await getMarketDevSocketSettingData()\r\n    }\r\n}\r\n\r\nlet dataImpl:IPageData|undefined\r\nexport async function marketsDevSettingsLoadDefData():Promise<IPageData>{\r\n    if(dataImpl){\r\n        return dataImpl;\r\n    }\r\n    let data:IPageData = await createDefPageData();\r\n    dataImpl = toProxy(data);\r\n    return dataImpl;\r\n}","import { AppbarContainer, AppPageDataWrapperShell } from \"@app/ui\";\r\nimport { autoWebViewJs } from \"@droid/android\";\r\nimport { Dispatcher, isValidWebSocketURL, useTranslation } from \"@fanfanlo\";\r\nimport { IScriptConf } from \"@market/lib\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { MarketsDevSettingsContent } from \"@src/components/page/markets-dev-settings/content/MarketsDevSettingsContent\";\r\nimport { MarketsDevSettingsContextProvider } from \"@src/components/page/markets-dev-settings/data/context\";\r\nimport { IPageData, marketsDevSettingsLoadDefData } from \"@src/components/page/markets-dev-settings/data/data.intf\";\r\nimport { marketsDevScriptLib } from \"@src/markets/markets-script-dev-lib\";\r\nimport { Suspense, use } from \"react\";\r\n\r\nexport default function MarketsDevSettingsPage() {\r\n    const { t } = useTranslation('homepage/pages/markets-dev-settings/content');\r\n    return (\r\n        <Suspense fallback={<div>{t(\"content.loadPageData\")}</div>}>\r\n            <Content pageData={marketsDevSettingsLoadDefData()} libInit={marketsDevScriptLib.init()} />\r\n        </Suspense>\r\n    )\r\n}\r\n\r\nfunction Content({ pageData, libInit }: { pageData: Promise<IPageData>, libInit: Promise<void> }) {\r\n\r\n    const { t } = useTranslation('homepage/pages/markets-dev-settings/content');\r\n    const data = use(pageData)\r\n    const dispatcher = new Dispatcher()\r\n    use(libInit)\r\n\r\n    async function onClick() {\r\n        const res = await getContacts();\r\n        console.log('on click res=', res);\r\n    }\r\n    return (\r\n        <AppPageDataWrapperShell\r\n            contextValue={data}\r\n            ContextProvider={MarketsDevSettingsContextProvider}\r\n        >\r\n            <AppbarContainer appbarProps={{ title: t(\"content.title\"), back: true, backDispatcher: dispatcher }}>\r\n                <Box>\r\n                    <Button onClick={onClick}>script</Button>\r\n                </Box>\r\n                <MarketsDevSettingsContent />\r\n            </AppbarContainer>\r\n        </AppPageDataWrapperShell>\r\n    )\r\n}\r\n\r\n\r\nfunction temp(id: string) {\r\n    const x = `\r\n\r\ncontactsPermission.permission = \"android.permission.READ_CONTACTS\";\r\n    var permissions = [contactsPermission];\r\n    var result = {\r\n      permissions: permissions,\r\n      permissionDenied: [],\r\n      permissionsSuccessed: [],\r\n      error: null,\r\n      data: null,\r\n      warning: null,\r\n      info: null,\r\n      isSuccess:false,\r\n    };\r\n\r\n    com.fanfanlo.lib.permissions.PermissionActivity.requestPermissions(context, permissions, true, \"SOS-读取联系人\", onCheckPermissionsCallback);\r\n    \r\n    function missionFailed(){\r\n      webViewJs.callJsEvent(\"${id}-missionFailed\", result, ${id});\r\n      missionComplete();\r\n    }\r\n    \r\n    function missionSuccess(){\r\n      webViewJs.callJsEvent(\"${id}-missionSuccess\", result, ${id});\r\n      missionComplete();\r\n    }\r\n\r\n    function missionComplete(){\r\n      webViewJs.callJsEvent(\"${id}-missionComplete\", result, ${id});\r\n    }\r\n    function onCheckPermissionsCallback(resultMap){\r\n      for(var i = 0; i < permissions.size(); i++){\r\n        var permissionInfo = permissions.get(i);\r\n        var permission = permissionInfo.permission;\r\n        if((permission in resultMap && resultMap[permission] == true) || permissionInfo.required == false)continue;\r\n        result.error = {\r\n          message:\"permission denied\",\r\n          extra:permissionInfo\r\n        }\r\n        missionFailed();\r\n        return;\r\n      }\r\n      runCodeAfterPermissionsAccess();\r\n    }\r\n    \r\n    function runCodeAfterPermissionsAccess(){\r\n      result.isSuccess = true;\r\n      missionSuccess();\r\n    }\r\n    \\`{isOk:\"true\"}\\`\r\n`\r\n}\r\n\r\n\r\nfunction createReadContactsScript(id: string) {\r\n    return `\r\n    var Manifest = Packages.android.Manifest;\r\n    var context = com.fanfanlo.lib.mc.LibMainModel.instance.application;\r\n    var contactsPermission = new Packages.com.fanfanlo.lib.permissions.PermissionRequest(\"android.permission.READ_CONTACTS\", true, null, null, null);\r\n// contactsPermission.permission = \"android.permission.READ_CONTACTS\";\r\n\r\n    var permissions = [contactsPermission];\r\n    var result = {\r\n      permissions: permissions,\r\n      permissionDenied: [],\r\n      permissionsSuccessed: [],\r\n      error: null,\r\n      data: null,\r\n      warning: null,\r\n      info: null,\r\n      isSuccess:false,\r\n    };\r\n    \r\n    com.fanfanlo.lib.permissions.PermissionActivity.requestPermissions(context, permissions, true, \"SOS-读取联系人\", onCheckPermissionsCallback);\r\n\r\n    function missionFailed(){\r\n        webViewJs.callJsEvent(\"${id}-missionFailed\", result, \"${id}\");\r\n        missionComplete();\r\n      }\r\n      \r\n      function missionSuccess(){\r\n        webViewJs.callJsEvent(\"${id}-missionSuccess\", result, \"${id}\");\r\n        missionComplete();\r\n      }\r\n  \r\n      function missionComplete(){\r\n        webViewJs.callJsEvent(\"${id}-missionComplete\", result, \"${id}\");\r\n      }\r\n      function onCheckPermissionsCallback(resultMap){\r\n        for(var i = 0; i < permissions.length; i++){\r\n          var permissionInfo = permissions[i];\r\n          var permission = permissionInfo.permission;\r\n          if(resultMap.get(permission) == true)continue;\r\n          if(permissionInfo.required == false)continue;\r\n          result.error = {\r\n            message:\"permission denied\",\r\n            extra:{\r\n                \"resultMap\":resultMap,\r\n                \"permission\":permission,\r\n                permissionInfo:permissionInfo\r\n            }\r\n          }\r\n          missionFailed();\r\n          return;\r\n        }\r\n        runCodeAfterPermissionsAccess();\r\n      }\r\n      \r\n      function runCodeAfterPermissionsAccess(){\r\n        result.isSuccess = true;\r\n        readContacts();\r\n        missionSuccess();\r\n      }\r\n\r\n      function readContacts(){\r\n        var contentResolver = com.fanfanlo.lib.mc.LibMainModel.instance.application.getContentResolver();\r\n        var ContactsContract = Packages.android.provider.ContactsContract;\r\n        var cursor = contentResolver.query(\r\n        ContactsContract.Contacts.CONTENT_URI,\r\n        null,\r\n        null,\r\n        null,\r\n        null\r\n        );\r\n\r\n        var contactList = [];\r\n        if (cursor !== null && cursor.moveToFirst()) {\r\n        var nameIndex = cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME);\r\n        var idIndex = cursor.getColumnIndex(ContactsContract.Contacts._ID);\r\n\r\n        do {\r\n            var contactName = cursor.getString(nameIndex);\r\n            var contactId = cursor.getString(idIndex);\r\n\r\n            // 查询电话号码\r\n            let phone = null;\r\n            var hasPhoneNumberIndex = cursor.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER);\r\n            var hasPhoneNumber = cursor.getInt(hasPhoneNumberIndex);\r\n            if (hasPhoneNumber > 0) {\r\n            var phoneCursor = contentResolver.query(\r\n                ContactsContract.CommonDataKinds.Phone.CONTENT_URI,\r\n                null,\r\n                ContactsContract.CommonDataKinds.Phone.CONTACT_ID + \" = ?\",\r\n                [contactId],\r\n                null\r\n            );\r\n\r\n            if (phoneCursor !== null && phoneCursor.moveToFirst()) {\r\n                var phoneIndex = phoneCursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);\r\n                phone = phoneCursor.getString(phoneIndex);\r\n                phoneCursor.close();\r\n            }\r\n            }\r\n\r\n            contactList.push({\r\n            name: contactName,\r\n            phone: phone,\r\n            });\r\n\r\n        } while (cursor.moveToNext());\r\n\r\n        cursor.close();\r\n        }\r\n\r\n        result.data = {contactList};\r\n        var json = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(result);\r\n        console.log(json);\r\n      }\r\n    `\r\n}\r\n\r\ninterface IPermission{\r\n    permission:string\r\n    required:boolean\r\n    reason:string\r\n    denyInfo:string\r\n    externalKey:string\r\n}\r\ninterface IErorr{\r\n    message:string,\r\n    extra:{\r\n        \"resultMap\":Record<string, boolean>,\r\n        \"permission\":string,\r\n        permissionInfo:IPermission\r\n    }\r\n  }\r\n\r\n  interface IData{\r\n    contactList:IContact[]\r\n  }\r\n  export interface IReadContactsResult {\r\n    permissions?: IPermission[];\r\n    permissionDenied?: IPermission[];\r\n    permissionsSuccessed?: IPermission[];\r\n    data?: IData;\r\n    isSuccess: boolean;\r\n    error?:IErorr\r\n  }\r\n  \r\n  export interface IContact {\r\n    name: string;\r\n    phone?: string;\r\n  }\r\n  \r\nexport async function getContacts() {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const id = '@fanfanlo/scripts/script001/get-contacts'\r\n        const conf: IScriptConf = {\r\n            bridgeId: id,\r\n            scriptId: id,\r\n            forceStopTime: 1000 * 60 * 20,\r\n            onlyRunSingle: true,\r\n            injects: [\"webViewJs\", \"console\"],\r\n            script: createReadContactsScript(id)\r\n\r\n        }\r\n        function onMessage(event: { type: string, data: IReadContactsResult }) {\r\n            console.log('llllllllllllllllllllllllllaaaddd', event)\r\n            switch (event.type) {\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionSuccess\":\r\n                    resolve(event.data);\r\n                    break;\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionSuccess\":\r\n                    reject(event.data);\r\n                    break;\r\n                case \"@fanfanlo/scripts/script001/get-contacts-missionComplete\":\r\n                    window.removeEventListener(\"message\", onMessage);\r\n                    break;\r\n            }\r\n        }\r\n        window.addEventListener('message', onMessage)\r\n        const res = autoWebViewJs.callScriptByConf(conf)\r\n        console.log('getContacts_fn res=', res)\r\n    })\r\n}"],"names":["storeUtils","createDefSocketSettingData","data","keepConnect","url","res","getNamespaceStoreWithData","defData","getMarketDevSocketSettingData","autoJsStoreUtils","toProxy","IMarketDevConnectEventType","IMarketDevServerEventType","WatchResourceType","marketsDevSocket","marketDevLibData","devLibInfo","getMarketScriptDataNsPrefix","createMarketScriptDataNsPath","ns","writeNsAllFiles","files","nsPath","oldFiles","read","name","Object","keys","index","indexOf","splice","content","write","removeFile","writeFile","readNsAllFiles","readFile","getAllMarkets","listenDev","dispatcher","addListener","getAllScripts","onGetAllScript","update","onFileUpdate","allMarketLibData","client","resourceType","Html","html","htmls","path","Js","resources","length","script","isInitialized","init","forceReset","console","log","marketsDevScriptLib","ScriptType","IMarketDevClientEmitEventType","SocketConnectStatusEnum","Dispatcher","isValidWebSocketURL","socketConnectInfo","status","disconnected","retryCount","ws","connect","connecting","w","WebSocket","onopen","connected","toGetAllScripts","onclose","arguments","checkNeedRetry","onerror","close","onmessage","e","event","JSON","parse","dispatch","type","error","send","stringify","undefined","settingData","setTimeout","disconnect","createTypedContext","MarketsDevSettingsContextProvider","useMarketsDevSettingsContext","getSocketConnectStatusEnumI18n","useProxyWatch","useTranslation","Box","Button","Checkbox","FormControlLabel","Grid2","Stack","TextField","useEffect","useState","URL","t","pageData","value","_setValue","socketSettingData","isWrong","setIsWrong","setValue","v","s","fullWidth","label","placeholder","helperText","variant","onChange","target","ConnectButton2","buttonName","setButtonName","enabled","setEnabled","updateButtonName","disconnecting","onClick","disabled","KeepConnectCheckbox","control","checked","span","style","fontSize","color","CheckboxButtonGroup","container","direction","spacing","size","DevSettings","IFrameReactContainer","useProxyWatchUpdates","createHtml","Script","resource","Scripts","map","MarketsDevSettingsContent","button","createDefPageData","dataImpl","marketsDevSettingsLoadDefData","AppbarContainer","AppPageDataWrapperShell","autoWebViewJs","Suspense","use","MarketsDevSettingsPage","fallback","div","Content","libInit","getContacts","contextValue","ContextProvider","appbarProps","title","back","backDispatcher","temp","id","x","createReadContactsScript","Promise","resolve","reject","conf","bridgeId","scriptId","forceStopTime","onlyRunSingle","injects","onMessage","window","removeEventListener","addEventListener","callScriptByConf"],"sourceRoot":"","ignoreList":[]}